# REINVENT4 Configuration - Mol2Mol Transformation
# Generated by meta-controller for {{ arm_name }}

run_type = "staged_learning"
device = "cpu"
json_out_config = "_mol2mol.json"

[parameters]
summary_csv_prefix = "{{ output_csv_prefix }}"
prior_file = "{{ prior_path }}"
agent_file = "{{ prior_path }}"
smiles_file = "seeds.smi"
sample_strategy = "multinomial"
distance_threshold = 100
use_checkpoint = false
purge_memories = false

batch_size = {{ batch_size }}
unique_sequences = true
randomize_smiles = {{ randomize_smiles | lower }}

[learning_strategy]
type = "dap"
sigma = {{ sigma }}
rate = {{ learning_rate }}

[diversity_filter]
type = "IdenticalMurckoScaffold"
bucket_size = {{ diversity_bucket_size }}
minscore = {{ diversity_minscore }}
minsimilarity = {{ diversity_minsimilarity }}
penalty_multiplier = {{ diversity_penalty }}

[[stage]]
chkpt_file = "agent.chkpt"
termination = "simple"
max_score = {{ max_score }}
min_steps = 10
max_steps = {{ max_steps }}

[stage.scoring]
type = "custom_product"

[[stage.scoring.component]]
[stage.scoring.component.molecular_weight]
[[stage.scoring.component.molecular_weight.endpoint]]
name = "Molecular weight"
weight = 1.0
params.low = {{ mw_min }}
params.high = {{ mw_max }}
transform.type = "double_sigmoid"
transform.high = {{ mw_max }}
transform.low = {{ mw_min }}
transform.coef_div = 500.0
transform.coef_si = 20.0
transform.coef_se = 20.0

[[stage.scoring.component]]
[stage.scoring.component.TPSA]
[[stage.scoring.component.TPSA.endpoint]]
name = "TPSA"
weight = 1.0
params.max = {{ tpsa_max }}
transform.type = "step"
transform.high = {{ tpsa_max }}

[[stage.scoring.component]]
[stage.scoring.component.SlogP]
[[stage.scoring.component.SlogP.endpoint]]
name = "logP"
weight = 1.0
params.low = {{ logp_min }}
params.high = {{ logp_max }}
transform.type = "double_sigmoid"
transform.high = {{ logp_max }}
transform.low = {{ logp_min }}
transform.coef_div = 5.0
transform.coef_si = 2.0
transform.coef_se = 2.0

[[stage.scoring.component]]
[stage.scoring.component.HBondDonors]
[[stage.scoring.component.HBondDonors.endpoint]]
name = "HBD"
weight = 1.0
params.max = {{ hbd_max }}
transform.type = "step"
transform.high = {{ hbd_max }}

[[stage.scoring.component]]
[stage.scoring.component.HBondAcceptors]
[[stage.scoring.component.HBondAcceptors.endpoint]]
name = "HBA"
weight = 1.0
params.max = {{ hba_max }}
transform.type = "step"
transform.high = {{ hba_max }}
